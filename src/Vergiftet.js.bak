import React, { useState, useEffect, useContext } from 'react';
});
setGrid(newGrid);
setPhase('selectP2');
setPopup(translations.selectP2);
};


const confirmStartGame = () => {
const newGrid = [...grid];
newGrid.forEach(cell => {
if (cell.selectedBy === 'p2') {
cell.showMarker = false;
}
});
setGrid(newGrid);
setPhase('playing');
setPopup(null);
};


const restart = () => {
const totalCells = rows * cols;
setGrid(generateGrid(totalCells));
setPoisonedIndexes([]);
setPhase('selectP1');
setPopup(translations.selectP1);
setLastMoveIndex(null);
};


const showSummary = () => {
const newGrid = [...grid];
poisonedIndexes.forEach((idx) => {
newGrid[idx].visible = true;
newGrid[idx].selectedBy = 'poisoned';
});
setGrid(newGrid);
setPhase('summary');
setPopup(translations.poisonShown);
};


return (
<div className="vergiftet-container">
{popup && (
<div className="popup">
<p>{popup}</p>
{phase === 'lost' || phase === 'summary' ? (
<>
<button onClick={restart}>{translations.newGame}</button>
<button onClick={() => window.location.href = '/'}>{translations.home}</button>
</>
) : null}
</div>
)}


{phase === 'waitP2' && (
<div className="summary-button">
<button onClick={confirmPlayer2}>{translations.startGame}</button>
</div>
)}


{phase === 'waitPlay' && (
<div className="summary-button">
<button onClick={confirmStartGame}>{translations.startGame}</button>
</div>
)}


{phase === 'lost' && (
<div className="summary-button">
<button onClick={showSummary}>{translations.showPoisoned}</button>
</div>
)}


<div className="grid">
{grid.map((cell, i) => (
<div
key={i}
className={`cell ${cell.color} ${cell.selectedBy} ${!cell.visible ? 'invisible' : ''}`}
onClick={() => handleCellClick(i)}
>
{cell.selectedBy === 'p1' && cell.showMarker !== false && <span className="x blue-x">X</span>}
{cell.selectedBy === 'p2' && cell.showMarker !== false && <span className="x red-x">X</span>}
{cell.selectedBy === 'lost' && <span className="x black-x">X</span>}
{cell.selectedBy === 'poisoned' && <span className="x gray-x">â˜ </span>}
</div>
))}
</div>
</div>
);
};


export default Vergiftet;